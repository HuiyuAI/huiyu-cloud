<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huiyu.service.core.mapper.PicMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="picMap" type="com.huiyu.service.core.entity.Pic">
        <result column="id" property="id"/>
        <result column="uuid" property="uuid"/>
        <result column="name" property="name"/>
        <result column="path" property="path"/>
        <result column="model_id" property="modelId"/>
        <result column="prompt" property="prompt"/>
        <result column="negative_prompt" property="negativePrompt"/>
        <result column="width" property="width"/>
        <result column="height" property="height"/>
        <result column="seed" property="seed"/>
        <result column="reference_pic_id" property="referencePicId"/>
        <result column="user_id" property="userId"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_delete" property="isDelete"/>
    </resultMap>

    <select id="getByUserId" resultMap="picMap">
        select *
        from t_pic
        where is_delete = 0
          and user_id = #{userId};
    </select>

    <select id="getByUuid" resultMap="picMap">
        select *
        from t_pic
        where is_delete = 0
          and uuid = #{uuid};
    </select>

    <update id="update">
        update t_pic
        <set>
            <if test="id != null">
                id = #{id},
            </if>
            <if test="uuid != null and uuid != ''">
                uuid = #{uuid},
            </if>
            <if test="path != null and path != ''">
                path = #{path},
            </if>
            <if test="modelId != null">
                model_id = #{modelId},
            </if>
            <if test="prompt != null">
                prompt = #{prompt},
            </if>
            <if test="negativePrompt != null">
                negative_prompt = #{negativePrompt},
            </if>
            <if test="width != null">
                width = #{width},
            </if>
            <if test="height != null">
                height = #{height},
            </if>
            <if test="seed != null">
                seed = #{seed},
            </if>
            <if test="referencePicId != null">
                referencePic_id = #{referencePicId},
            </if>
            <if test="userId != null">
                user_id = #{userId},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
            <if test="isDelete != null">
                is_delete = #{isDelete},
            </if>
        </set>
        where id = #{id}
    </update>

    <select id="getAll" resultMap="picMap">
        select *
        from t_pic
        where is_delete = 0
        <if test="id != null">
            and id = #{id}
        </if>
        <if test="uuid != null and uuid != ''">
            and uuid = #{uuid}
        </if>
        <if test="path != null and path != ''">
            and path = #{path}
        </if>
        <if test="modelId != null">
            and model_id = #{modelId}
        </if>
        <if test="prompt != null">
            and prompt = #{prompt}
        </if>
        <if test="negativePrompt != null">
            and negative_prompt = #{negativePrompt}
        </if>
        <if test="width != null">
            and width = #{width}
        </if>
        <if test="height != null">
            and height = #{height}
        </if>
        <if test="seed != null">
            and seed = #{seed}
        </if>
        <if test="referencePicId != null">
            and referencePic_id = #{referencePicId}
        </if>
        <if test="userId != null">
            and user_id = #{userId}
        </if>
    </select>


</mapper>
